{% extends "clubs_base.html" %}{% load staticfiles %}
{% block title %}{{ club.name }}{% endblock %}

{% block content %}
<h2>{{ club.name }}</h2>
{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
<div class="col-md-3">
	<div class="panel panel-primary" data-collapsed="0">
		<!-- panel head -->
		<div class="panel-heading">
			<div class="panel-title">خيارات</div>
		</div>
		
		<!-- panel body -->
		<div class="panel-body">
			<p style="font-size:1em;"><ul class="list-unstyled">
			{% if can_edit %}<li><a href="{% url 'clubs:edit' club.pk %}"><span class="glyphicon glyphicon-pencil"></span> عدّل</a></li>{% endif %}
			{% if can_view_members %}<li><a href="{% url 'clubs:view_members' club.pk %}"><span class="entypo-users"></span> استعرض أعضاء النادي</a></li>{% endif %}
			{% if can_view_deputies %}<li><a href="{% url 'clubs:view_deputies' club.pk %}"><span class="entypo-users"></span> استعرض نواب النادي</a></li>{% endif %}
			{% if can_view_applications %}<li><a href="{% url 'clubs:view_application' club.pk %}"><span class="glyphicon glyphicon-list-alt"></span> راجع طلبات الانضمام</a></li>{% endif %}
			{% if user.is_authenticated and club.registration_is_open and user.common_profile.city == club.city and user.common_profile.college.gender == club.gender or user.is_authenticated and club.registration_is_open and not club.gender %}
			<li><a href="{% url 'clubs:join' club.pk %}"><span class="glyphicon glyphicon-star"></span> انضم للنادي</a></li>
			{% endif %}
            <li><a href="{% url 'forms:form_list' club.id %}"><span class="entypo-docs"></span> النماذج</a></li>
			</ul></p>
		</div>
	</div>
</div>
<div class="col-md-9">
<table class="tg table-hover table">
  <colgroup>
    <col class="col-xs-2">
    <col class="col-xs-6">
  </colgroup>
  <tr>
    <th>الاسم الإنجليزي</th>
    <td class="english-field">{{ club.english_name }}</td>
  </tr>{% if club.description %}
  <tr>
    <th>الوصف</th>
    <td>{{ club.description }}</td>
  </tr>
{% endif %}  <tr>
    <th>البريد الإلكتروني</th>
    <td class="english-field">{{ club.email }}</td>
  </tr>
  <tr>
    <th>المنسق</th>
    <td>{% if club.coordinator %} {{ club.coordinator.common_profile.get_ar_full_name|default:club.coordinator.username }} {% else %} لا يوجد {% endif %}</td>
  </tr>
  <tr>
    <th>تاريخ الإنشاء</th>
    <td>{{ club.creation_date|date:"j F Y" }}</td>
  </tr>
</table>
</div>
<h3>النشاطات</h3>
{% if activities %}
<table class="display datatable">{% load l10n %}
    <thead>
        <tr>
            <th>الاسم</th>
            <th>تاريخ الانعقاد</th>
        </tr>
    </thead>
    <tbody>
    {% for activity in activities %}
        <tr>
            <td><a href="{% url 'activities:show' activity.id %}">{{ activity.name }}</a></td>
            <td data-order="{{ activity.get_first_date|date:"U" }}">{{ activity.get_first_date|date:"j F" }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>لا توجد نشاطات.</p>
{% endif %}
</div>

{% endblock %}

{% block customscript %}
	<script src="{% static 'neon/assets/js/fullcalendar/fullcalendar.min.js' %}"></script>
	<link rel="stylesheet" href="{% static 'css/jquery.dataTables.min.css' %}">
	<script src="{% static 'js/jquery.dataTables.min.js' %}"></script>
<script>
    var approved_table = $('.datatable:first').DataTable({
        "order": [[ 2, "asc" ]],
        "language": {% include 'js/dataTables-arabic.json' %}
    });
    var approved_table_nodes = approved_table.column(2, {order: 'current'}).nodes();
    for (i=0; i < approved_table_nodes.length; i++) {
       if ($(approved_table_nodes[i]).data('order') > unix_seconds) {
            var page_number = Math.floor( i / approved_table.page.info().length );
            approved_table.page(page_number).draw(false);
            break
       }
    }
</script>
{% endblock %}
