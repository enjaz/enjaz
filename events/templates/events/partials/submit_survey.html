{% load bootstrap3 %}{% load staticfiles %}
<style>

</style>
<div class="form-group">
<form  enctype="multipart/form-data" id="edit-survey-form" action="post">
{% csrf_token %}
{% bootstrap_form form layout='horizontal' %}
</form>
</div>
<script type="text/javascript">
$(function () {
    // modify form submission behaviour to be ajaxy
    $("form#edit-survey-form").submit(function (event) {

        /* stop form from submitting normally */
        event.preventDefault();
        var formData = new FormData($(this)[0]);
        var url = "{% url 'events:handle_survey' session.pk survey.pk%}";

        /* Send the data */
        $.ajax({
            url: url,
            type: 'POST',
            data: formData,
            cache: false,
            contentType: false,
            enctype: 'multipart/form-data',
            processData: false,
            success: function (data) {
                if (data.message == "success") {
                    // show success message (using toastr)
                    toastr.options.positionClass = "toast-top-left";
                    toastr.success("تم تعبئة استبيان {{ session.name }} بنجاح.");
                    window.location.href= data.show_url;

                } else {
                    $("#edit-survy-modal .modal-body").html(data);
                }}
        });
    });
});
            
</script>

{#        /* get some values from elements on the page: */#}
{#        var formData = new FormData($(this)[0]); #}
{#        {% if survey %}{# if a group is passed, then post to edit_group url, otherwise to add_group #}
{#        var url = "{% url 'events:handle_survey' session.pk survey.pk %}";#}
{#        {% else %}#}
{#        var url = "{% url 'bulb:add_group' %}";#}
{#        {% endif %}#}
